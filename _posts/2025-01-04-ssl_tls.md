---
title: "💬SSL/TLS란? feat.대칭키&비대칭키"
date: 2025-01-04 16:26 +0900
categories: [CS]
tags: [SSL, TLS, 대칭키, 비대칭키]
---

## SSL/TLS 소개 

HTTPS에서 마지막의 S는 Over Secure Socket Layer의 약자로 보안이 강화된 HTTP입니다. SSL/TLS 기반으로 동작하여 HTTPS 통신을 위한 암호화 및 인증 메커니즘을 제공합니다.  
우리가 접근하는 웹 사이트가 https://~ 로 시작한다면, 웹 서버의 보안이 강화되어 데이터 통신이 안정적으로 전달됨을 의미합니다.  

![no_https](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/no_https.png?raw=true)

#### SSL? TLS 뭐가 다른걸까?

SSL(Secure Sockets Layer)와 TLS(Transport Layer Secyrity)는 뭐가 다를까요? 

**같다고 봐도 무방**합니다. TLS는 SSL의 이름이 바뀐 것입니다. 당시 Netscape와 Microsoft 간에 웹의 우위를 위한 싸움이 있었습니다. Microsoft를 위해 SSL 프로토콜 이름이 TLS로 변경되었습니다. 

> 이 글에서는 편의상 TLS라 부르겠습니다. 

#### TLS의 중요성

TLS는 현재 가장 널리 사용되는 네트워크 보안 프로토콜입니다. TLS는 OSI 모델의 응용 계층과 전송 계층 사이에서 작동하며 다음과 같은 보안 기능을 제공합니다. 

- 데이터 암호화 : 클라이언트와 서버 간의 통신을 암호화하여 데이터의 기밀성을 보장합니다. 
- 인증 : 통신 당사자의 신원을 확인하여 중간자 공격을 방지합니다. 
- 데이터 무결성 : 전송 중 데이터의 변조를 방지하고 탐지합니다. 


## SSL 인증서, CA란?

`SSL`(Secure Sockets Layer) 인증서는 웹 사이트의 신원을 확인하고 암호화된 연결을 설정하는 데 사용되는 디지털 문서입니다. 

주요 특징:
- 웹사이트의 소유권 확인
- 데이터 암호화를 위한 공개키 포함
- HTTPS 연결 활성화
- 웹사이트에 대한 신뢰 제공 

`CA`(Certificate Authority)는 디지털 인증서를 발급하고 관리하는 신뢰할 수 있는 제3자 기관입니다. SSL 인증서를 발급하고, 신원 확인, 디지털 서명 제공, 유효성 관리 등을 담당합니다.

아래 그림은 SSL 인증서의 발급 과정과 검증 과정을 나타냅니다.

![ssl_ca](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/ssl_ca.png?raw=true)

- 1,2 과정은 서버 관리자가 SSL 인증서를 요청하여 발급받는 과정입니다. 사전에 한 번만 진행하면 만료될 때까지 유지됩니다.
- 3,4 과정은 클라이언트가 서버로 연결을 시도하면 서버는 SSL 인증서를 나타냅니다. 
- 5,6 과정에서 클라이언트는 서버로부터 SSL 인증서를 받아 CA 기관에서 확인하는 과정입니다. CA의 공개키로 인증서의 디지털 서명을 검증합니다.
- 마지막으로 클라이언트가 SSL 인증서 검증을 마쳤다는 것과 안전한 연결을 설정할 준비가 되었음을 서버에 알립니다. 

이 과정은 서버와 클라이언트가 연결하기 위한 SSL/TLS 프로토콜의 핸드셰이크 과정입니다. SSL/TLS 핸드셰이크 과정은 `대칭키`와 `비대칭키 암호화` 방식을 하이브리드로 사용하기에 먼저 설명한 이후 SSL/TLS 핸드셰이크 과정을 알아보겠습니다.

## 양방향 대칭키 암호화 

![symmetric_key](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/symmetric_key.png?raw=true)

양뱡향 대칭키 암호는 주로 데이터의 기밀성을 보호하는 데 사용합니다. 암호화된 데이터를 복호화하기 위해 암호화할 때 사용한 키가 있어야 복호화할 수 있기 때문에, 데이터를 안전하게 전송할 수 있습니다. 대칭키 암호화는 암호화와 복호화에 동일한 키를 사용합니다. 

> 수신자와 송신자는 데이터 통신 전에 키를 교환하여 서로 동일한 키를 가지고 있어야 합니다. 이 시점은 일반적으로 암호화된 통신 세션을 시작하기 전에 이루어집니다. 키를 공유하는 방법에는 **사전 공유 방법, 키 배포 센터(KDC), Diffie-Hellman 키 교환, 공개키 암호 활용** 등이 있습니다.  

**대칭키 암호화의 장점**은 키의 길이가 비교적 짧기에 암호화 및 복호화 속도가 빠르고 대량의 데이터 처리에 적합합니다. 또한 알고리즘의 구현이 간단합니다.

**대칭키 암호화의 단점**은 **키를 교환해야 하는 문제**가 발생한다. 이는 키를 교환하는 중 키가 탈취될 수도 있다는 말이다. 또한 사용자가 많아질 수록 관리해야 할 키가 많아진다는 단점이 있습니다. 


> 대칭키 암호화는 대부분 데이터 전송, 파일이나 데이터베이스의 암호화에서 사용하며, HTTPS 통신에서 3-way handshake가 끝난 이후 데이터 전송에 대칭키 암호화를 사용합니다. 


## 단방향 비대칭키 암호화

![asymmetric_key](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/asymmetric_key.png?raw=true)

비대칭키 암호화는 데이터 무결성을 검증하는 데 사용합니다. 개인키는 공개키로 암호화된 데이터를 복호화할 수 있는 유일한 방법에 사용되며, 디지털 서명, 인증, 부인 방지 등에 사용됩니다. 비대칭키 암호화는 개인키를 복호화에 사용하고, 암호화에 공유키를 사용합니다.

**비대칭키 암호화의 장점**

- 안전하게 키를 교환 가능하여 대칭키의 안전한 공유가 가능해집니다. 
- 인증과 암호화를 동시에 수행하기에 당사자의 신원을 확인할 수 있어, 중간자 공격의 위험을 크게 줄일 수 있습니다. 
- 디지털 서명을 통해 데이터의 변조 여부를 확인할 수 있어 데이터 무결성을 보장합니다. 이는 정보의 신뢰성을 높일 수 있음을 의미합니다.
- 다수 사용자 간 통신에 효과적입니다. 공개키는 누구나 접근할 수 있음으로, 다수의 사용자가 서로의 공개키를 쉽게 공유할 수 있습니다. 또한 개인키는 공유할 필요가 없기 때문에 안전하게 보관만 하면 시스템의 보안성이 향상됩니다.

**비대칭키 암호화의 단점**

- 대칭키 암호화에 비해 속도가 현저히 느립니다. 복잡한 수학적 연산으로 인해 컴퓨팅 리소스가 높아 대용량 데이터 암호화에는 적합하지 않습니다.
- 키 관리가 복잡합니다. 공개키와 개인키 두 개의 키를 관리해야 하므로 키 관리가 더 복잡해지며, 개인키를 분실하면 암호화된 메시지를 복호화할 수 없게 딥니다.

> 비대칭키 암호화는 현대 암호 시스템의 핵심 요소로, 인터넷 보안, 전자 상거래, 디지털 서명 등 다양한 분야에서 활용되고 있습니다. 특히 HTTPS 프로토콜에서는 비대칭키를 이용해 안전하게 대칭키를 교환한 후, 실제 데이터 통신은 빠른 대칭키 암호화를 사용하는 하이브리드 방식을 사용합니다.


## TLS 핸드셰이크 과정

위에서 대칭키와 비대칭키에 대해 알아보았습니다. TLS 핸드셰이크에서는 비대칭 암호키의 안전성과 대칭 암호키의 효율성을 모두 활용하는 하이브리드 암호화 시스템을 구현합니다. TLS의 핸드셰이크 과정에서 대칭키와 비대칭키 어떻게 사용되는지 TLS 핸드셰이크 과정을 살펴보면서 알아보겠습니다.

TLS(Transport Layer Security) 핸드셰이크 단계는 클라이언트와 서버 간에 전송되는 데이터그램 또는 메시지로 구성됩니다. 

> 통신에 사용할 암호화 알고리즘에 따라 TLS 핸드셰이크 과정이 달라집니다.
{: .prompt-info }

과정의 단계는 다음과 같습니다. 


![tls_handshake](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/tls_handshake.png?raw=true)

- ❶클라이언트가 "Client Hello" 메시지를 보내 연결을 시작합니다.

- ❷❸❹서버는 "Server Hello", SSL 인증서, 그리고 필요한 경우 ServerLeyExchange 메시지로 응답합니다.
    - Server Hello에서 클라이언트가 제안한 옵션 중 TLS 버전과 암호화 알고리즘을 선택하여 응답합니다. 서버의 랜덤 데이터를 포함하여 전송합니다.
    - Certificate는 SSL 인증서를 클라이언트에게 전송합니다. 여기에 `서버의 공개키`가 포함되어 있습니다.
    - Server Key Exchange는 일부 키 교환 방식에서 필요한 경우, 서버는 추가적인 키 교환 정보를 전송합니다.

- ❺❻❼클라이언트는 Client Key Exchange, Change Cipher Spec, 그리고 Finished 메시지를 보냅니다.
    - Client Key Exchange는 클라이언트가 `서버의 공개키`로 암호화한 프리마스터 시크릿을 생성하여 서버에 전송합니다.
    - Change Cipher Spec는 협상된 암호화 방식을 사용할 것을 알립니다.
    - Finished는 클라이언트가 지금까지의 핸드셰이크 메시지들의 해시를 암호화하여 전송하여 핸드셰이크 과정에서 변조가 일어나지 않음을 알립니다.

- ❽❾서버도 Change Cipher Spec과 Finished 메시지로 응답합니다.
    - Change Cipher Spec는 서버도 협상된 암호화 방식을 사용할 것을 알립니다.
    - Finished 서버도 핸드셰이크 메시지들의 해시를 암호화하여 전송합니다.
- 핸드셰이크가 완료되면 양측은 암호화된 애플리케이션 데이터를 교환할 수 있습니다. 서로 협상된 세션 키를 사용하여 암호화된 데이터를 안전하게 교환합니다.

이 과정을 통해 TLS는 초기에 비대칭키 암호화를 사용하여 안전하게 키를 교환하여 서로의 신원을 확인하고, 안전한 통신을 합니다. 이후 실제 데이터 통신에는 더 효율적인 대칭키 암호화를 사용합니다. 또한 비대칭키는 핸드셰이크의 초기 단계에서 사용하고, 대칭키는 핸드셰이크 후반부와 이후 통신에서 사용합니다. 이러한 방식으로 TLS는 비대칭 암호화의 안전성과 대칭 암호화의 효율성을 모두 활용하여, 초기 키 교환을 안전하게 수행하고, 대칭 암호화는 빠른 데이터 전송을 담당합니다.


## TLS 관련 취약점과 대응책

TLS는 인터넷 통신의 보안을 위해 사용되는 프로토콜이지만, 취약점과 한계점이 존재합니다. 이 글에서 간단하게 살펴보겠습니다. 

주요 TLS 취약점으로는 POODLE, BEAST, CRIME, Heartbleed, Lucky 13 등이 있으며, 이들은 주로 오래된 TLS 버전이나 잘못된 구현에서 발생합니다. 이러한 취약점들은 암호화된 데이터의 해독, 민감한 정보 유출, 중간자 공격 등을 가능하게 만들어 심각한 보안 위협이 될 수 있습니다.  

또한 TLS은 높은 지연 시간, 구형 시스템과의 호환성 문제, 최신 TLS 1.3버전에 대한 제한적인 지원 등의 이유로 어쩔 수 없는 한계점이 존재합니다. 보안과 한계점들을 해결하기 위해서 강력한 암호 스위트를 선택하고, 정기적인 보안 업데이트와 취약점 스캔 등을 수행해야합니다. 하지만 레거시 시스템과의 호환성 유지, 업그레이드에 따른 비용 문제 등의 문제로 완전한 보안 강화에 어려움이 있습니다. 

TLS 취약점 관리는 다른 보안 정책들에 비해 더 높은 우선순위를 가지기 때문에, 이에 대한 관리는 필수적입니다.

## 마치며

이상으로 TLS가 동작하는 과정에 대해 살펴보고 대칭키와 비대칭키에 대한 설명과 TLS 핸드셰이크에서 어떻게 사용되는지에, 그리고 어떤 취약점과 한계점이 있는지 살펴보았습니다.  

TLS는 현대 웹 보안에서 중요한 위치에 자리잡고 있습니다. 전자 상거래, 온라인 뱅킹, 이메일 등 민감한 정보를 다루는 모든 온라인 서비스에서 필수적입니다. 따라서 개발자는 TLS가 동작하는 방식과 개념에 대해서 아는 것은 중요하다고 생각합니다. 다음에는 TLS의 설정 방법에 대해 소개드리겠습니다. 
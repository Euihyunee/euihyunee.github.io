---
title: "💬 Docker란 무엇이고, VM과의 차이점?"
date: 2025-03-05 09:05 +0900
categories: [CS]
tags: [Docker, VM, Docker File, Docker Image, Docker Container]
---

> 도커(Docker)와 가상 머신(VM)은 각기 다른 가상화 기술로 현대 IT 인프라에서 중요한 역활을 합니다. 기존 시스템에서 여러 애플리케이션을 구동하기 위해 다양한 패키지, 환경설정 등을 설정을 맞추는 과정에서 여러 충돌이 일어나는 문제 때문에 시스템을 운영하기 어려웠습니다. 이런 문제를 해결하기 위해 VM이 나왔지만 이는 무거운 단점이 존재했습니다. 여기에 민첩성과 효율성을 갖춘 도커가 나왔습니다. 이 글에서 도커의 개념과 구조, 그리고 VM과의 차이점에 대해 알아보겠습니다.

## 가상화와 컨테이너 

도커를 설명하기 전에 먼저 가상화와 컨테이너에 대해 먼저 설명드리겠습니다. `가상화`는 하나의 하드웨어를 여러 개의 가상 머신으로 분할해 효율적으로 사용할 수 있는 기술입니다. 분할된 가상 머신들은 각각 독립적인 환경으로 구동됩니다. 이때 컴퓨터 하드웨어에 직접 설치된 주 운영체제를 Host OS라 부르고, 가상 머신(VM) 내부에서 실행되는 추가 운영체제를 Guest OS라고 부릅니다.

![virtual_container.png](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/virtual_container.png?raw=true)

가상 머신(VM)은 하이퍼바이저를 통해 전체 하드웨어를 가상화합니다. 이는 완벽한 환경으로 격리시키며 다양한 OS를 동시 실행 가능하다는 장점이 있지만 OS 부팅이 필요하기에 실행 속도가 느리며 해당 환경을 구동하는 데 필요한 파일을 모두 가지고 있기 때문에 이미지의 크기가 매우 커진다는 한계점이 존재합니다. 

반면 컨테이너는 호스트 OS 커널을 공유하여 프로세스 격리만 수행합니다. 이때 애플리케이션과 의존성만 패키징하기에 이미지 크기가 작으며 실행이 빨라 자원 효율성을 극대화할 수 있습니다. 하지만 호스트 OS 커널에 종속되기에 다른 OS를 실행할 수 없으며 단일 컨테이너 침해 시 전체 시스템이 위험한 보안 이슈가 있습니다.

## 도커(DockerN)란?

도커(Docker)는 리눅스 컨테이너에 리눅스 애플리케이션 격리 기술을 사용하여 더 쉽게 컨테이너로 실행하고 관리해주는 오픈소스 프로젝트입니다. 개발자는 도커를 이용하여 이미지를 실행시켜 컨테이너 생성, 컨테이너 관리, 다시 이미지로 만드는 작업 등을 쉽게 할 수 있습니다. 

도커는 컨테이너라는 독립된 환경을 만들어 공통된 시스템 툴, 환경설정, 의존성을 하나에 묶어서 사용하기에 종속성 이슈에서 벗어날 수 있으며 필요한 라이브러리를 일일히 설치하는 작업이 필요없게 됩니다.

도커는 다음과 같은 이점이 있습니다.

1. 독립된 환경을 가지기에 호스트 OS, 다른 컨테이너와도 독립되어 충돌이 발생하지 않습니다.
2. 컨테이너 내부에서 작업 후 도커 이미지만 만들어 운영 서버에서 쉽게 배포할 수 있습니다.
3. 마이크로 서비스 구조로 변경에 용이합니다. 단일 서비스만 재배포 가능하며 버전 관리가 효율적입니다.

> 결론적으로, Docker을 사용하면 환경에 구애받지 않고, 애플리케이션을 빠르게 배포, 확장, 변경할 수 있습니다.
{: .prompt-tip }

## 도커의 구성요소 

도커에는 도커 파일(Docker File), 도커 이미지(Docker Image), 도커 컨테이너(Docker Container)로 구성되어 있습니다. 

![docker_component.png](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/docker_component.png?raw=true)

### 도커 파일(Docker File)

도커 파일은 이미지를 생성하기 전에 이미지를 구성하는 명령어들을 작성한 파일이다. 도커 이미지를 생성하기 위한 템플릿으로 다음과 같은 내용이 있습니다.

- 애플리케이션을 구동하기 위한 파일
- 의존성(Dependencies) 다운 목록
- 운영체제 설치, 패키지 추가, 환경 변수 설정 등
- 구동 방식에 대한 script

이를 빌드하면 자동으로 이미지가 생성됩니다. 도커 파일을 통해 애플리케이션 빌드와 배포를 자동화할 수 있습니다.

```docker
FROM ubuntu:22.04     # 베이스 이미지 지정
COPY . /app           # 파일 복사
RUN make /app         # 빌드 명령 실행
CMD ["/app/server"]   # 컨테이너 시작 시 실행할 명령
```

### 도커 이미지(Docker Image)

도커 이미지는 도커 파일을 기반으로 빌드된 `읽기 전용(read-only)` 파일 시스템으로 애플리케이션에 필요한 코드, 라이브러리, 환경 설정 등을 포함합니다. 도커 이미지는 다음과 같은 특징이 있습니다.

- 불변성: 생성 후 수정이 불가능하며, 변경 시 새 이미지를 빌드해야 합니다.
- 레이어 구조: 여러 계층으로 구성되며, 공통 레이어는 다른 이미지/컨테이너와 공유되어 저장 공간을 절약합니다.
- 저장 및 배포: Docker Hub나 Harbor와 같은 레지스트리에 저장되어 팀 또는 공개적으로 공유될 수 있습니다.

### 도커 컨테이너(Docker Container)

도커 이미지를 기반으로 생성된 인스턴스입니다. 실행 가능한 환경으로, 애플리케이션을 격리된 상태로 실행합니다. 도커 컨테이너는 다음과 같은 특징이 있습니다. 

- 쓰기 가능 레이어: 이미지의 읽기 전용 레이어 위에 쓰기 가능한 임시 계층을 추가하여 파일 시스템 변경을 저장합니다. 
- 일회성: 컨테이너 종료 시 쓰기 레이어가 삭제되며, 데이터 유지를 위해 볼륨(Volume)을 사용해야 합니다.
- 격리성: 호스트 OS의 커널을 공유하지만, 프로세스/네트워크/파일 시스템이 독립적으로 관리됩니다.
- 독립성: 한 서버는 여러 개의 컨테이너를 가져도 상관없으며 독립적으로 실행됩니다.
- 1:N 관계: 도커 컨테이너는 이미지의 인스턴스로 하나의 도커 이미지에 여러 개의 도커 컨테이너가 존재할 수 있습니다.

## 도커의 라이프 사이클

![docker_behavior.png](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/docker_behavior.png?raw=true)

- `Docker Client`: 도커를 설치한 곳이 Client이며 build, pull, run 등의 도커 명령어를 수행합니다.
- `DOCKER_HOST`: 도커를 띄운 서버입니다. 여기서 컨테이너와 이미지를 관리합니다.
- `Docker daemon`: 도커 엔진의 핵심 프로세스로, 컨테이너 관리, 이미지 관리, 가상 네트워크 생성, 볼륨을 통한 데이터 영구화, API 제공 등의 역활을 합니다. 
- `Registry`: 외부(Remote) 이미지 저장소로 다른 사람들이 공유한 이미지를 내부로 pull 할 수 있습니다. 

클라이언트에서 도커 파일을 `실행(build)`하여 도커 이미지를 생성하며, 도커 이미지를 `run`하여 도커 컨테이너를 만듭니다. 또한 외부 저장소에 저장된 도커 이미지를 Registry에서 `pull`하여 가져올 수 있습니다. 

## 가상 머신(VM)과 도커(Docker)의 차이점

기존의 가상화 기술인 가상 머신(Virtual Machine)은 하이퍼바이저(Hypervisor)를 이용해 전체 OS를 가상화합니다. 따라서 호스트 커널 공유를 하지 않기에 다른 OS를 이용할 수 있으며 안정성과 보안면에서 좋습니다. 하지만, 가상화 대상이 전체 OS로 부담스러운 이미지 크기와 느린 속도라는 단점이 있습니다.

반면, 도커는 호스트 OS의 커널을 공유하며 컨테이너를 사용합니다. 또한, 가상화된 공간을 생성하기 위해 리눅스 자체 기능(chroot, namespace, cgroup)을 사용하여 프로세스 단위의 격리 환경을 만듭니다. 덕분에 컨테이너에 필요한 파일만 존재하기 때문에 이미지의 용량 또한 가상 머신에 비해 대폭 줄어들어 빠르고, 성능 손실도 거의 없습니다. 다만 커널 공유로 인한 보안 취약점이 존재하고 단일 컨테이너 침해 시 전체 시스템이 위험합니다. 

|구분|가상 머신(VM)|도커(Docker)|
|:--|:--|:--|
|**아키텍처**|하이퍼바이저 기반 전체 OS 가상화|호스트 OS 커널공유 컨테이너 방식|
|**가상화 대상**|하드웨어 + OS 전체|애플리케이션 계층|
|**자원 효율성**|독립적 자원 할당 → 오버헤드 큼|호스트 자원 공유 → 경량|
|**시작 시간**|수 분 소요 (전체 OS 부팅 필요)|수 초 내 시작|
|**격리 수준**|완전한 하드웨어 수준 격리|프로세스 수준 격리|
|**이미지 크기**|GB 단위 (OS 포함)|MB 단위 (앱 종속성만 포함)|
|**주요 사용 사례**|레거시 시스템, 크로스플랫폼 환경| 클라우드 네이티브, 마이크로서비스|
|**호환성**|모든 OS 지원 (Windows/Linux 등)|호스트 OS 커널 기반 (리눅스 최적화)|

## 사용 사례

기술 선택 가이드

Docker 선택 시:  
✔️ 개발/테스트/운영 환경의 일관성 필요  
✔️ 빠른 스케일 아웃과 CI/CD 파이프라인 구축  
✔️ 마이크로서비스 기반의 분산 애플리케이션 개발  
✔️ 웹 애플리케이션, 데이터베이스 서버 등에서 사용

VM 선택 시:  
✔️ Windows/Linux 등 다른 OS 동시 실행 필요  
✔️ 금융·의료 등 높은 보안 수준 요구  
✔️ 물리적 하드웨어 제어가 필요한 특수 목적 시스템  
✔️ 레거시 시스템 호스팅, 독립적인 테스트 환경 등에서 사용

> 도커는 민첩성과 효율성을, VM은 안정성과 격리를 우선시 할 때 선택할 수 있습니다. 클라우드 네이티브 환경에서는 도커가, 레거시 시스템 통합에는 VM이 더 적합하지만, 최근에는 두 기술을 혼용하는 하이브리드 아키텍처도 증가하고 있습니다.

## 마치며

Docker와 가상 머신(VM)은 애플리케이션 격리 및 배포를 위한 서로 다른 접근 방식을 제공하는 기술입니다. Docker는 컨테이너 기반의 경량화된 가상화 솔루션이며, VM은 하드웨어 수준의 완전한 가상화를 구현합니다. 두 기술의 주요 차이점은 자원 사용 효율성, 실행 속도, 격리 수준에서 나타납니다.

> 개발자는 프로젝트의 요구사항을 정확히 분석해 Docker와 VM의 적절한 조합을 찾아야 합니다. 기술의 이해에 따라 더 스마트한 인프라 설계가 가능해집니다. 
{: .prompt-info }
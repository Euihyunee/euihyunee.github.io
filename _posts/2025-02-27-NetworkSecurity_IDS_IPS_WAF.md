---
title: "💬 네트워크 보안에 대해서 feat.방화벽,IDS/IPS, WAF"
date: 2025-02-27 12:20 +0900
categories: [CS]
tags: [Network, Security, 방화벽, IDS, IPS, WAF]
---

> 방화벽, IDS/IPS, WAF는 **네트워크 보안의 3대 핵심 기술**로 각기 다른 계층과 방식으로 시스템을 보호합니다. 3가지의 기술은 계층적 보안 체계를 구성하며 방화벽(Firewall)은 네트워크 전반의 기본 차단을, IDS/IPS(침입 탐지/방지 시스템)는 네트워크와 애플리케이션 계층에서 실시간으로 위협을 탐지하고 차단을, WAF(Web Application Firewall)는 웹 애플리케이션에 특화된 보호를 담당합니다. 이 글에서는 위 3가지 기술들에 대해 알아보겠습니다.

## 방화벽(Firewall)

네트워크 방화벽은 신뢰할 수 있는 내부 네트워크와 외부 네트워크 사이의 보안 경계 역활을 하는 시스템입니다. 쉽게 말해서 디지털 공간의 첫 번째 문지기 역활을 합니다. 기본 동작 계층은 Layer3(네트워크 계층)와 Layer4(전송 계층)에서 주로 동작합니다. 

> OSI 모델의 1~2계층(물리 계층과 데이터 링크 계층)에서의 보안은 물리적 인프라와 네트워크 장비 자체에서 직접 처리됩니다.
{: .prompt-info }

![firewall.png](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/firewall.png?raw=true)

> DMZ(Demilitarized Zone)는 내부 네트워크와 외부 네트워크 사이에 위치한 중간 보호 구역으로, 외부 공격으로부터 내부 자원을 보호하면서도 공개 서비스를 안전하게 제공하기 위해 설계되었습니다. 
{: .prompt-tip }

### 방화벽의 기본 기능

방화벽의 기능들은 사전 정의된 보안 규칙을 기반으로 악의적인 트래픽을 차단하고 신뢰할 수 있는 통신만을 허용하여 네트워크 보안을 강화합니다.

#### 1️⃣접근 통제

방화벽의 가장 기본적인 기능은 패킷 필터링(IP 주소, 포트, 프로토콜을 기반으로 트래픽을 허용/차단하는 기술)을 통해 내부와 외부 네트워크 간의 접근을 통제하는 것입니다. IP 주소, 포트 번호, 프로토콜 등을 분석해 사전 설정된 규칙에 따라 트래픽을 허용 또는 차단합니다. 

예를 들어, 외부에서 특정 포트로의 접근을 차단해 해킹 시도를 방지할 수 있습니다. 또한 'deny by default' 정책을 적용해 명시적으로 허용되지 않은 모든 트래픽을 차단하는 방식으로 Zero Trust 모델을 지원합니다.

#### 2️⃣인증 

방화벽은 메시지 인증, 사용자 인증, 클라이언트 인증을 제공합니다. VPN을 통한 신뢰된 통신 보장, OTP나 토큰 기반의 사용자 인증, 모바일 장치와 같은 특정 호스트의 신원 확인 등을 수행합니다. 이를 통해 승인되지 않은 사용자의 네트워크 접근을 차단합니다.

#### 3️⃣감사 및 로깅

모든 네트워크 활동을 기록하는 감사 및 로깅 기능은 보안 사고 발생 시 원인 분석과 대응에 필수적입니다. 트래픽 허용/차단 내역, 정책 변경 이력, 관리자 접근 로그 등을 저장해 추적 가능성을 높입니다.

#### 4️⃣프록시 기능

방화벽은 클라이언트와 서버 사이에서 프록시 서버 역활을 수행할 수 있습니다. 외부 요청을 중계하면서 내부 네트워크 구조를 숨기고, 콘텐츠 필터링을 통해 악성 코드 전파를 방지합니다.

#### 5️⃣NAT(네트워크 주소 변환)

NAT는 내부 네트워크의 IP 주소를 외부에 공개되지 않도록 변환합니다. 여러 장치가 하나의 공인 IP를 공유할 수 있게 하여 외부에서 내부 IP를 추적하기 어렵게 만듭니다. 이는 네트워크 프라이버시 보호에 기여합니다.

### 방화벽의 유형

네트워크 방화벽은 다양한 유형과 기술로 발전해 왔습니다. 주요 유형을 계층별 동작 방식과 기술 발전 세대를 중심으로 설명드리겠습니다.

1. **패킷 필터링 방화벽(1세대):**  
OSI 3-4계층(네트워크/전송 계층)에서 동작하며, IP 주소/포트/프로토콜 기반 필터링을 수행합니다.
    - 1970년대 최초로 개발된 기본 형태
    - 라우터에서 헤더 정보 표면 검사만 수행
    - 장점: 설정이 간편하고 시스템 부하가 적다.
    - 단점: 패킷 내용 검사가 불가하고, 세션 추적 기능이 없다.
2. **서킷 레벨 게이트웨이:**  
TCP 핸드셰이크 검증에 초점을 맞춘 방식입니다.
    - 세션 연결의 합법성 확인
    - 장점: 리소스 사용이 효율적이다.
    - 단점: 악성 코드를 포함한 패킷이 통과할 수도 있다.
3. **상태 기반 검사(2세대):**  
연결 상태(context)를 추적하는 `Stateful Inpection` 기술 적용
    - 패킷 헤더 + 페이로드 동시 분석
    - 연결 상태 테이블을 유지해 세션 관리
    - 장점: 양방향 트래픽 자동 허용
    - 단저미 정책 증가 시 성능 저하
4. **애플리케이션 프록시(3세대):**  
OSI 7계층(응용 계층)에서 동작하는 고급 방화벽
    - 웹 애플리케이션 보호(WAF)에 특화
    - 전체 패킷 내용 검사 및 프록시 중개 서비스 제공
    - 장점: SQL 인젝션 등 웹 공격 방어
    - 단점: 처리 지연 발생 가능

## 침입 탐지 시스템(IDS)과 침입 방지 시스템(IPS)

IDS(Intrusion Detection System)와 IPS(Intrusion Prevention System)는 네트워크 보안을 강화하기 위한 핵심 기술로, 외부 공격과 내부 위협을 탐지 및 차단하는 역활을 수행합니다. 두 시스템은 상호 보완적으로 작동하며 방화벽과 함께 다층적 보안 체계를 구성합니다.

<style>
  .img_container_box {
    display: flex;
    flex-wrap: wrap;
  }
  .left-div-example, .right-div-example {
    flex: 1;
    min-width: 300px; /* 최소 너비 설정 */
  }
  .left-div-example img {
    width: 100%;
    height: auto;
  }
  @media (max-width: 768px) {
    .right-div-example {
      flex-basis: 100%;
      order: 2;
    }
  }
</style>

<div class="img_container_box">

  <div class="left-div-example">
    <img src="https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/OSI-IDS-IPS.png?raw=true" alt="OSI-IDS-IPS">
  </div>

  <div markdown="1" class="right-div-example">

IDS와 IPS는 OSI 3~7계층에서 동작합니다. 이는 방화벽과 달리 패킷의 헤더뿐만 아니라 페이로드 내 데이터까지 분석하며 애플리케이션 수준의 공격을 탐지 및 차단하기 위함입니다.

1. 네트워크 계층(3계층): IP 주소 기반 공격(ex: IP 스푸핑)탐지
2. 전송 계층(4계층): TCP/UDP 포트 스캔, SYN Flooding 같은 전송 계층 공격 감지
3. 세션/표현 계층(5~6계층): 세션 하이재킹, 암호화되지 않은 데이터 변조 시도 탐지
4. 응용 계층(7계층): 웹 애플리케이션 공격(SQL 삽입, XSS), 악성 파일 전송, 비정상적인 API 호출 등 심층 분석

</div>
</div>


### IDS(Intrusion Detection System)

침입탐지시스템(IDS)은 네트워크 트래픽이나 시스템 활동을 실시간으로 모니터링하여 비정상적인 패턴을 식별하고 관리자에게 경고합니다.

- 탐지 중심: 공격을 차단하지 않고 로깅 및 경고에 집중
- 탐지 방법:
    - 시그니처 기반: 알려진 공격 패턴과 비교(오탐률 낮음)
    - 이상 행위 기반: 정상 활동 프로파일과의 편차 분석(새로운 공격 탐지 가능)
- 배치 유형
    - NIDS(네트워크 기반): 전체 네트워크 트래픽 분석
    - HIDS(호스트 기반): 개별 시스템의 로그 및 활동 감시

> 시그니처(Signature) 방식이란? 알려진 공격 패턴을 미리 정의해 탐지하는 방식입니다. 개발자는 공격 당할 만한 패턴과 공격 당했던 패턴을 데이터베이스에 저장하고 이를 트래픽 또는 파일에서 매칭합니다. 이 방식은 알려지지 않은 패턴은 방어할 수 없으므로 AI 이상 탐지를 결합하거나 새 위협 패턴을 실시간으로 분석해 자동 시스니처를 생성하는 등의 보완 전략이 있습니다.
{: .prompt-info }

### IPS(Intrusion Prevention System)

침입방지시스템(IPS)은 IDS(침입탐지시스템)의 탐지 기능에 실시간 차단 기능을 추가한 능동형 보안 솔루션입니다.

- 차단 기능: 악성 트래픽을 인라인 방식으로 차단
- 고급 방어: 응용 프로그램 계층 공격 대응 및 암호화 트래픽 분석 지원
- 자동화 대응: 공격 차단, 세션 종료, 보안 장치 연동 등의 즉각 조치 

> 인라인 방식이란 네트워크 보안 장비가 트래픽 경로에 직접 배치되어 실시간 차단을 수행하는 방식을 의미합니다. 네트워크 패킷은 반드시 보안 장비를 통과하도록 구성되어 있습니다.
{: .prompt-info }

|구분|IDS|IPS|
|:--|:--|:--|
|기능|탐지 및 경고|실시간 차단|
|배치 방식|수동 모니터링|인라인 설치|
|성능 영향|네트워크 영향 적음|처리 지연 가능성|
|공격 대응|사후 분석 지원|사전 예방 기능|
|탐지 정확도|오탐 시 경고만 발생|오탐 시 네트워크 차단 가능성|

### 방화벽과의 연계 방식

![FW-IPS-IDS.png](https://github.com/Euihyunee/euihyunee.github.io/blob/main/_posts/img/FW-IPS-IDS.png?raw=true)

1. Basic Access Control(Firewall, 방화벽):  
네트워크에 대한 기본적인 접근 제어를 수행하여 허용된 트래픽만 통과시킵니다.
2. Deep Packet Inspection(IPS, 침입방지 시스템):  
통과된 트래픽을 심층적으로 검사하여 악성 트래픽을 실시간으로 차단합니다.
3. Threat Analysis(IDS, 침입탐지 시스템):  
최종적으로 위협 분석을 통해 이상 징후를 탐지하고 관리자에게 경고합니다.

> 방화벽과의 연계 외에도 하이브리드 탐지, SSL 트래픽 검사 통합 보안 전략이 있습니다. IDS와 IPS는 각각 탐지와 차단이라는 명확한 역활 분담을 통해 네트워크 보안의 완성도를 높입니다.

## 웹 애플리케이션 방화벽(WAF)

웹 애플리케이션 방화벽(WAF, Web Application Firewall)은 웹 애플리케이션의 보안을 위해 특화된 방화벽으로, 애플리케이션 계층(OSI 7계층, 응용 계층)에서 HTTP/HTTPS 트래픽을 실시간으로 분석해 악성 공격을 차단합니다.

### WAF의 주요 기능

1. 공격 차단 기능:
    - OWASP Top 10 대응: SQL 인젝션, XSS(크로스 사이트 스크립팅), CSRF(사이트 간 요청 위조) 등 주요 웹 취약점을 실시간 탐지/차단
    - 규칙 기반 필터링: 사전 정의된 시그니처(악성 패턴 DB)와 커스텀 보안 규칙을 적용해 비정상 트래픽 식별
    - 애플리케이션 프로파일링: 허용된 URL, 데이터 유형, 쿼리 패턴을 분석해 변칙 요청 차단
2. 트래픽 관리 체계
    - 역방향 프록시 역할: 클라이언트와 서버 사이에서 모든 HTTP/HTTPS 트래픽을 검사하며, 실제 서버 구조를 숨김
    - 트래픽 정규화: 요청/응답 데이터의 구조를 표준화해 위장 공격 방지
    - 속도 제한(Rate Limiting): IP별 요청 빈도 제어로 DDoS/브루트 포스 공격 차단
3. 보안 강화 매커니즘
    - AI기반 이상 탐지: 머신러닝을 활용해 정상 트래픽 패턴에서 벗어나는 변칙 동작 감지
    - 암호화 통신 관리: SSL/TLS 복화를 대신 처리하며, 암호화 구간에서의 보안 위협 감시
    - API 보호: REST/SOAP API 엔드포인트를 대상으로 한 비정상 호출 모니터링
4. 운영 지원 기능
    - 실시간 로깅 & 모니터링: 모든 트래픽에 대한 상세 기록을 생성해 포렌식 분석 지원
    - 컴플라이언스 대응: PCI DSS, GDPR 등 규정 준수를 위한 감사 로그 자동 생성
    - SIEM 통합: Splunk, QRadar 등 보안 시스템과 연동해 위협 인텔리전스 강화


### 일반 방화벽과 WAF의 차이점

물론, 기존의 방화벽(Firewall) 또한 애플리케이션 계층에서 트래픽을 분석합니다. 하지만 방화벽은 HTTP/HTTPS에서 `포트 80/443`을 사용하는 트래픽에 대해서만 검사를 진행하며 단순히 특정 대역의 포트(80 또는 443)의 접근을 차단하는 역활을 합니다. 한계점으로 암호화된 HTTPS 트래픽 내용을 검사할 수 없다는 것입니다.

여기서 웹 애플리케이션 방화벽(WAF)는 HTTP 요청의 전체 구조(헤더, URI, 본문)을 분석하고 암호화된 트래픽을 SSL/TLS 오프로딩을 통해 복호화한 뒤 검사(페이로드)를 수행합니다. 또한 공격 탐지 매커니즘으로 XSS 시도가 포함된 악성 트래픽은 차단할 수 있습니다.

|구분|전통적 방화벽|WAF|
|:--|:--|:--|
|트래픽 분석 계층|네트워크(L3~L4)|애플리케이션(L7)|
|검사 대상|IP/Port, 패킷 헤더|HTTP 헤더, URI, 쿠키, 페이로드|
|포트80/443 처리|포트 열기/닫기만 제어|포트는 허용하되 내용 검사|
|암호화 트래픽|암호화 유지 상태로 통과/차단|복호화-> 악성 코드 검사 -> 재암호화|
|차단 공격 유형|SYN Flood, IP 스푸핑|SQL 삽입, XSS, CSRF|
|의사결정 기준|"어디서 오는가"<br>(IP/Port)|"무엇을 전송하는가"<br>(페이로드)


## 마치며

네트워크 보안의 방화벽(Firewall), IDS/IPS, WAF를 알아보았습니다. 이러한 시스템들은 상호 보완적으로 작동하여 네트워크와 애플리케이션의 전체 데이터 흐름을 보호합니다. 또한 네트워크 보안은 하나의 기술로 진행하는 것이 아닌 데이터 입력, 데이터 구조, 데이터 출력 부분과 OSI 모델의 계층별로 네트워크 트래픽을 분석하고 보호합니다. 

이렇듯 네트워크 보안에는 `다중 방어 전략` 개념이 있습니다. 이는 단일 보안 수단에 의존하지 않고 여러 계층의 보안 조치를 중첩적으로 적용해 사이버 위협으로부터 시스템을 보호하는 접근법입니다. 각 계층에서 독립적으로 작동하기에 한 계층이 뚫리더라도 다른 계층에서 위협을 차단할 수 있습니다.

네트워크 보안을 이루기 위해서는 방화벽, IDS/IPS, WAF의 통합 운용이 필요합니다. 보안 시스템들의 개념을 이해하는 것은 다층적인 보안 전략을 수립하는 데 필수적입니다. 이러한 개념을 이해함으로써 효과적인 보안 정책을 수립하고, 적절한 보안 도구를 선택하며, 잠재적인 취약점을 식별하고 해결할 수 있습니다.